// TOML parser implementation, v0.0.3
// Copyright (c)2013 alexander.beletsky@gmail.com
// Distributed under MIT license
// http://github.com/alexander.beletsky/toml.js
(function(e,t){typeof exports=="object"?module.exports=t():typeof define=="function"&&define.amd&&define(t)})(this,function(){var toml=function(){var parseGroup=function(e,t,n){function s(e){var t=e.indexOf("["),n=e.indexOf("]");return e.substring(t+1,n)}function o(e){return e.split(".")}function u(t,n){var r=t[n]={};e.currentGroup=r}function a(e,t){t.reduce(function(t,n){return e[t]||u(e,t),u(e[t],n),n})}var r=s(n);if(r.indexOf(".")!==-1){var i=o(r);a(t,i)}else u(t,r)},parseExpression=function(context,result,line){function parseNameValue(e){var t=e.indexOf("=");return{name:e.substring(0,t),value:e.substring(t+1)}}function parseValue(e){function t(e){return e.charAt(0)==="["&&e.charAt(e.length-1)==="]"}return t(e)?parseArray(e):parsePrimitive(e)}function parseArray(e){function n(e){function r(e){var t=[],n=!1,r=0;for(var i=0;i<e.length;i++){var s=e[i];s==="["?r++:s==="]"&&r--,s===","&&r===0&&t.push(i)}return t.push(e.length),t}var t=[],n=e.substring(1,e.length-1),r=r(n);return r.reduce(function(e,r){return t.push(n.substring(e+1,r)),r},-1),t}var t=n(e);return t.map(function(e){return parseValue(e)})}function parsePrimitive(value){function date(e){return/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z/.test(e)}return date(value)?new Date(value):eval(value)}var pair=parseNameValue(line),value=parseValue(pair.value),currentGroup=context.currentGroup||result;currentGroup[pair.name]=value},parseLine=function(e,t,n){function r(e){return e.charAt(0)==="["}function i(e){return e.indexOf("=")>0}function s(e){return e===""}function o(){delete e.currentGroup}r(n)?parseGroup(e,t,n):i(n)?parseExpression(e,t,n):s(n)&&o()},parse=function(e){function i(e){return e.replace(/\s/g,"")}function s(e){return e.split("#")[0]}var t={},n={},r=e.toString().split("\n");return r.forEach(function(e){e=s(i(e)),parseLine(n,t,e)}),t};return{parse:parse}}();return toml});